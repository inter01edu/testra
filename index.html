<!doctype html> 
<html>
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">

    <style>
      html, body, table, td, a, div {
        font-family: Gotham, "Gotham", Times New Roman, sans-serif;
      }

      .logo01edu img:first-child {
        width: 90px;
        max-width: 90px;
        height: auto;
        display: block;
        margin: 0 auto;
      }

      .logo01edu { text-align: center; }

      .social img {
        width: 22px;
        height: 22px;
        display: block;
      }

      .social table {
        width: auto !important;
        margin: 0 auto !important;
        border-collapse: collapse;
      }

      .sig-text td { padding: 1px 0; line-height: 1.3; }

      .toolbar {
        display: flex;
        gap: 6px;
        margin: 6px 0 14px;
        user-select: none;
      }
      .toolbar button {
        font-size: 12px;
        padding: 4px 8px;
        cursor: pointer;
        border-radius: 4px;
        border: 1px solid #ccc;
        background: #f7f7f7;
      }
    </style>
  </head>

  <body>
    <script>
      function slugify(str) {
        return (str || "")
          .toLowerCase()
          .trim()
          .replace(/\s+/g, "-")
          .replace(/[^a-z0-9-]/g, "");
      }

      // Gmail (HTML clipboard)
      function copyForGmail(id) {
        const el = document.getElementById(id);
        if (!el) return alert("Signature introuvable.");

        navigator.clipboard.write([
          new ClipboardItem({
            "text/html": new Blob([el.outerHTML], { type: "text/html" }),
            "text/plain": new Blob([el.innerText || ""], { type: "text/plain" })
          })
        ]).then(() => alert("Signature copiÃ©e pour Gmail âœ…"))
          .catch(() => fallbackCopySelection(el, "Signature copiÃ©e âœ… (fallback)"));
      }

      // Outlook + Mail iCloud (sÃ©lection rÃ©elle)
      function copyForSelectionClients(id, label) {
        const el = document.getElementById(id);
        if (!el) return alert("Signature introuvable.");

        const range = document.createRange();
        range.selectNode(el);

        const sel = window.getSelection();
        sel.removeAllRanges();
        sel.addRange(range);

        try {
          document.execCommand("copy");
          alert(`Signature copiÃ©e pour ${label} âœ…`);
        } catch (e) {
          alert("SÃ©lectionne manuellement puis Ctrl/Cmd + C.");
        }

        sel.removeAllRanges();
      }

      fetch("https://opensheet.elk.sh/1maVoCpxQUmelT_wpZzTZERPzW4y20zGeoLtQuxbFvXQ/1")
        .then(r => r.json())
        .then(users =>
          users.filter(Boolean).map(({ firstname, lastname, title, mobile }) => {
            const slug = slugify(`${firstname} ${lastname}`);

            return `
<div class="toolbar">
  <button onclick="copyForGmail('${slug}')">ðŸ“‹ Gmail</button>
  <button onclick="copyForSelectionClients('${slug}', 'Outlook')">ðŸ“‹ Outlook</button>
  <button onclick="copyForSelectionClients('${slug}', 'Mail iCloud')">ðŸ“‹ Mail iCloud</button>
</div>

<div id="${slug}">
<table cellpadding="0" cellspacing="0" border="0" style="width:100%;border-collapse:collapse;table-layout:fixed;">
<tr>
<td width="90">
  <table>
    <tr>
      <td class="logo01edu">
        <img src="https://raw.githubusercontent.com/inter01edu/testra/main/images/logo01edu.png"
             width="90" height="90"
             style="display:block;border:0;width:90px;height:auto;">
      </td>
    </tr>
    <tr><td height="6"></td></tr>
    <tr>
      <td class="social">
        <table>
          <tr>
            <td style="padding:0 2px;">
              <a href="https://www.linkedin.com/company/01edu/">
                <img src="https://raw.githubusercontent.com/inter01edu/testra/main/images/linkedin.png"
                     width="22" height="22"
                     style="display:block;border:0;">
              </a>
            </td>
            <td style="padding:0 2px;">
              <a href="https://www.youtube.com/@01Edu_ai">
                <img src="https://raw.githubusercontent.com/inter01edu/testra/main/images/youtube.png"
                     width="22" height="22"
                     style="display:block;border:0;">
              </a>
            </td>
            <td style="padding:0 2px;">
              <a href="https://www.instagram.com/01edu_ai/">
                <img src="https://raw.githubusercontent.com/inter01edu/testra/main/images/instagram.png"
                     width="22" height="22"
                     style="display:block;border:0;">
              </a>
            </td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</td>

<td width="2"></td>
<td width="3" style="background:#0063f9;"></td>
<td width="3"></td>

<td>
  <table class="sig-text">
    <tr><td style="font-size:12px;">Recode Our World With</td></tr>
    <tr><td style="font-weight:bold;color:#0063f9;">${firstname} ${lastname}</td></tr>
    <tr><td style="font-weight:bold;font-size:12px;">${title}</td></tr>
    ${mobile ? `<tr><td style="font-size:12px;">Mobile: ${mobile}</td></tr>` : ""}
    <tr><td style="font-size:12px;"><a href="https://www.01edu.ai">www.01edu.ai</a></td></tr>
  </table>
</td>
</tr>
</table>
</div>
`;
          })
        )
        .then(html => document.body.innerHTML += html.join("<br>"));
    </script>
  </body>
</html>
